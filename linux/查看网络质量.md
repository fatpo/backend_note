## 1、ping
```
ping www.baidu.com
```

## 2、mtr
ping 有的时候被对端禁用。

当客户端访问目标服务器或负载均衡，使用ping命令测试出现丢包或不通时，可以通过MTR等工具进行链路测试来判断问题来源。

```
># mtr -r www.baidu.com
Start: 2022-09-23T08:59:32+0000
HOST: vsim3                       Loss%   Snt   Last   Avg  Best  Wrst StDev
  1.|-- ???                       100.0    10    0.0   0.0   0.0   0.0   0.0
  2.|-- 100.100.100.1              0.0%    10    0.5   0.5   0.4   0.8   0.1
  3.|-- 10.64.5.205                0.0%    10    1.1   2.4   1.1   6.7   2.2
  4.|-- 10.64.4.217                0.0%    10    1.0   4.8   1.0  17.7   6.1
  5.|-- 10.64.0.249                0.0%    10    2.8   4.7   0.9  30.2   9.0
  6.|-- Unassigned230.nyiix.net    0.0%    10    1.7   2.0   1.7   3.0   0.4
  7.|-- 223.118.11.89              0.0%    10   21.0  21.1  20.9  21.4   0.2
  8.|-- 223.118.12.66              0.0%    10   69.6  69.6  69.3  70.9   0.5
  9.|-- 221.183.30.173             0.0%    10  215.4 216.1 215.4 218.4   1.0
 10.|-- 221.183.25.122             0.0%    10  215.3 215.3 215.1 215.8   0.2
 11.|-- 221.176.22.157             0.0%    10  222.7 219.3 218.9 222.7   1.2
 12.|-- 111.24.5.193               0.0%    10  220.6 214.5 211.2 222.2   4.3
 13.|-- ???                       100.0    10    0.0   0.0   0.0   0.0   0.0
 14.|-- 120.196.198.198           90.0%    10  219.6 219.6 219.6 219.6   0.0
 15.|-- 120.241.49.42              0.0%    10  226.9 227.9 226.8 230.1   1.0
 16.|-- ???                       100.0    10    0.0   0.0   0.0   0.0   0.0
 17.|-- ???                       100.0    10    0.0   0.0   0.0   0.0   0.0
 18.|-- ???                       100.0    10    0.0   0.0   0.0   0.0   0.0
 19.|-- ???                       100.0    10    0.0   0.0   0.0   0.0   0.0
 20.|-- 183.232.231.173            0.0%    10  224.3 224.4 224.3 224.6   0.1
```

mtr的参数：
```
-r 或 -report：以报告模式显示输出。
-p 或 -split：将每次追踪的结果分别列出来。
-s 或 -psize：指定ping数据包的大小。
-n 或 -no-dns：不对IP地址做域名反解析。
-a 或 -address：设置发送数据包的IP地址。用于主机有多个IP时。
-4：只使用IPv4协议。
-6：只使用IPv6协议。

另外，也可以在mtr命令运行过程中，输入相应字母来快速切换模式。
？或 h：显示帮助菜单。
d：切换显示模式。
n：切换启用或禁用DNS域名解析。
u：切换使用ICMP或UDP数据包进行探测。
```

我们一般用`mtr -r` 就好了。

## 3、dig
dig （域信息搜索器）命令是一个用于询问 DNS 域名服务器的灵活的工具。

```
># dig google.com

; <<>> DiG 9.11.3-1ubuntu1.17-Ubuntu <<>> google.com
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 28220
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 65494
;; QUESTION SECTION:
;google.com.			IN	A

;; ANSWER SECTION:
google.com.		181	IN	A	142.250.64.110

;; Query time: 0 msec
;; SERVER: 127.0.0.53#53(127.0.0.53)
;; WHEN: Fri Sep 23 08:43:49 UTC 2022
;; MSG SIZE  rcvd: 55
```

稍微解释下返回，dig 命令默认的输出信息比较丰富，大概可以分为 5 个部分：
```
第一部分显示 dig 命令的版本和输入的参数。
第二部分显示服务返回的一些技术详情，比较重要的是 status。如果 status 的值为 NOERROR 则说明本次查询成功结束。
第三部分中的 "QUESTION SECTION" 显示我们要查询的域名。
第四部分的 "ANSWER SECTION" 是查询到的结果。
第五部分则是本次查询的一些统计信息，比如用了多长时间，查询了哪个 DNS 服务器，在什么时间进行的查询等等。
```
默认情况下 dig 命令查询 A 记录，上图中显示的 A 即说明查询的记录类型为 A 记录。常见的 DNS 记录类型：

|DNS类型|备注|
|:---|:---|
|A|	地址记录，用来指定域名的 IPv4 地址，如果需要将域名指向一个 IP 地址，就需要添加 A 记录。|
|AAAA	|用来指定主机名(或域名)对应的 IPv6 地址记录。|
|CNAME	|如果需要将域名指向另一个域名，再由另一个域名提供 ip 地址，就需要添加 CNAME 记录。|
|MX|	如果需要设置邮箱，让邮箱能够收到邮件，需要添加 MX 记录。|
|NS	|域名服务器记录，如果需要把子域名交给其他 DNS 服务器解析，就需要添加 NS 记录。|
|SOA	|SOA 这种记录是所有区域性文件中的强制性记录。它必须是一个文件中的第一个记录。|
|TXT	|可以写任何东西，长度限制为 255。绝大多数的 TXT记录是用来做 SPF 记录(反垃圾邮件)。|


# 4、参考

* [linux dig 命令](https://www.cnblogs.com/sparkdev/p/7777871.html)
* [MTR工具使用说明与结果分析](https://help.aliyun.com/document_detail/98706.html)
